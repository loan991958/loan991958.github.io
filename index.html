<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hi·ªÉn th·ªã Excel b·∫±ng JS</title>

  <!-- Th∆∞ vi·ªán SheetJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- Th∆∞ vi·ªán Danfo.js (gi·ªëng pandas cho JS) -->
  <script src="https://cdn.jsdelivr.net/npm/danfojs@1.1.2/lib/bundle.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    table {
      border-collapse: collapse;
      margin-top: 10px;
      max-width: 100%;
      overflow-x: auto;
      overflow-y: auto;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 4px 8px;
      font-size: 13px;
    }
    th {
      background-color: #eee;
    }
    #info {
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>üìä Hi·ªÉn th·ªã d·ªØ li·ªáu t·ª´ e1.xlsx</h2>
  <div id="info">ƒêang t·∫£i file...</div>
  <div id="excelData"></div>

  <script>
    async function loadExcel() {
      const url = "Excel/e1.xlsx"; // file excel n·∫±m trong th∆∞ m·ª•c Excel

      try {
        // T·∫£i file Excel
        const response = await fetch(url);
        const arrayBuffer = await response.arrayBuffer();

        // ƒê·ªçc b·∫±ng SheetJS
        const workbook = XLSX.read(arrayBuffer, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];

        // Chuy·ªÉn th√†nh JSON (array of arrays)
        const data = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        // N·∫øu file r·ªóng
        if (data.length === 0) {
          document.getElementById("info").innerText = "‚ùå File Excel tr·ªëng.";
          return;
        }

        // D√πng Danfo.js ƒë·ªÉ x·ª≠ l√Ω
        let df = new dfd.DataFrame(data.slice(1), { columns: data[0] });

        // Hi·ªÉn th·ªã th√¥ng tin
        document.getElementById("info").innerText =
          `‚úÖ ƒê√£ t·∫£i ${url} | Rows: ${df.shape[0]} | Cols: ${df.shape[1]}`;

        // Xu·∫•t b·∫£ng HTML (ch·ªâ hi·ªÉn th·ªã 50 d√≤ng ƒë·∫ßu cho nh·∫π)
        let table = "<table><thead><tr>";
        df.columns.forEach(col => table += `<th>${col}</th>`);
        table += "</tr></thead><tbody>";

        df.values.forEach(row => {
          table += "<tr>";
          row.forEach(cell => {
            table += `<td>${cell !== undefined ? cell : ""}</td>`;
          });
          table += "</tr>";
        });
        table += "</tbody></table>";

        document.getElementById("excelData").innerHTML = table;

      } catch (err) {
        document.getElementById("info").innerText = "‚ùå L·ªói: " + err.message;
        console.error(err);
      }
    }

    loadExcel();
  </script>
</body>
</html>

