<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Dá»‹ch vÃ  phÃ¡t láº¡i báº±ng tiáº¿ng Anh</title>
</head>
<body>
  <h2>ğŸ¤ NÃ³i báº±ng tiáº¿ng Viá»‡t â†’ ğŸ”Š Nghe báº±ng tiáº¿ng Anh</h2>
  <button id="mic1_button">ğŸ™ï¸ NÃ³i tiáº¿ng Viá»‡t</button>
  <button id="mic2_button" style="display:none;">ğŸ”Š Nghe tiáº¿ng Anh</button>

<script >//--------
let listUrlYt = ["https://youtu.be/sk=proj=epXwjLAeKPLBuTFMvjDmdQAhDVbhKcSZJ60xkDI4iF419uvhXC7GZ7jS7CHl8=OCemM293KtU5T3BlbkFJJ14i4QAWBYiJQbPMNBOMtspp8QL==mVbG2uig2oq44YGtjW9TFb3DdQuIrKYm7kNvvTnUqKoUA"];
///GFG_FunBo();
function maHoaLaiAK(){
    let ch = listUrlYt[listUrlYt.length - 1].split("be/")[1].replaceAll("=","-");
    //console.log(ch);
    return ch;
}
let apiKey=maHoaLaiAK();

// HÃ m gá»i GPT Ä‘á»ƒ dá»‹ch tiáº¿ng Viá»‡t sang tiáº¿ng Anh
async function sendToGPT(prompt) {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${apiKey}`,
        },
        body: JSON.stringify({
            model: "gpt-4o-mini",
            messages: [{ role: "user", content: prompt }]
        }),
    });

    const data = await res.json();
    const reply = data.choices[0].message.content;
    return reply;
}


async function translateWithGPT(vietnameseText) {
  const prompt = `Dá»‹ch cÃ¢u sau sang tiáº¿ng Anh má»™t cÃ¡ch tá»± nhiÃªn: "${vietnameseText}"`;
  
  const englishText = await sendToGPT(prompt); // HÃ m nÃ y báº¡n Ä‘Ã£ cÃ³
  //alert(englishText);
  return englishText;
}

// HÃ m phÃ¡t Ã¢m tiáº¿ng Anh
function speakEnglish(text) {
  if ('speechSynthesis' in window) {
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'en-US';
    speechSynthesis.speak(utterance);
  } else {
    console.log("TrÃ¬nh duyá»‡t khÃ´ng há»— trá»£ speechSynthesis");
  }
}

// Nháº­n giá»ng nÃ³i tiáº¿ng Viá»‡t tá»« mic1
document.getElementById("mic1_button").onclick = () => {
  const recognition = new webkitSpeechRecognition();
  recognition.lang = 'vi-VN';
  recognition.continuous = false;
  recognition.interimResults = false;

  recognition.onresult = async (event) => {
    const vietnameseText = event.results[0][0].transcript;
    console.log("Báº¡n nÃ³i:", vietnameseText);
    //alert(vietnameseText);

    // Dá»‹ch báº±ng GPT
    const englishText = await translateWithGPT(vietnameseText);
    console.log("GPT dá»‹ch:", englishText);

    // GÃ¡n hÃ nh Ä‘á»™ng cho mic2 Ä‘á»ƒ phÃ¡t láº¡i
    const mic2 = document.getElementById("mic2_button");
    mic2.style.display = "inline";
    mic2.onclick = () => speakEnglish(englishText);
    mic2.click(); // tá»± Ä‘á»™ng phÃ¡t luÃ´n
  };

  recognition.onerror = (e) => {
    console.error("Lá»—i nháº­n giá»ng nÃ³i:", e.error);
  };

  recognition.start();
};
</script>

<body>
</html>
