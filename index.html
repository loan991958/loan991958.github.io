<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat in 2 languages</title>
<style>
body {
    background-image: linear-gradient(30deg, #1666b0, #fbfafb); 
    color: #fff;
    font: 1rem/1 'Poppins', sans-serif;
    height:100%;
    padding: 20px;
    max-width: 700px; 
    margin: auto;
}

h2 { 
  text-align: center; 
  color:rgb(4, 4, 95);
}


#chatbox { 
  border: 1px solid #ccc; 
  padding: 10px; 
  height: 320px; 
  overflow-y: scroll; 
  margin-bottom: 10px; 

  position: relative; /* l√†m g·ªëc t·ªça ƒë·ªô cho ph·∫ßn t·ª≠ con */
}
.overlay-btn {
  position: absolute;
  top: 10px;      /* kho·∫£ng c√°ch t·ª´ tr√™n xu·ªëng */
  right: 10px;    /* kho·∫£ng c√°ch t·ª´ ph·∫£i sang */
  z-index: 20;    /* ƒë·∫£m b·∫£o n√∫t n·∫±m tr√™n */
  border-color: transparent ;
  background: transparent;
  color:white;
  transition: transform 0.2s ease;
}
.overlay-btn:hover {
  transform: scale(1.5); /* ph√≥ng to gap ruoi */
}

.menu-group {
  display: flex;
  justify-content: space-between;
  padding: 0 10%; /* c√°ch bi√™n tr√°i v√† ph·∫£i 20px */
  width: 100%;
  box-sizing: border-box;
}


.menu-group select {
  width: 40%; /* ho·∫∑c tu·ª≥ ch·ªânh theo nhu c·∫ßu */
  padding: 8px;
  font-size: 16px;
  background-color: transparent;
}
.button-group {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%; /* ho·∫∑c ƒë·∫∑t chi·ªÅu r·ªông c·ª• th·ªÉ */
  padding: 10px 0px; /* tu·ª≥ ch·ªânh kho·∫£ng c√°ch l·ªÅ */
}
#mic1_button {
    width: 70px; /* K√≠ch th∆∞·ªõc n√∫t */
    height: 70px;
    border-radius: 50%; /* L√†m cho n√∫t tr√≤n */
    /*background-image: url("icons/mic1-animation.gif");  ·∫¢nh b√™n trong */
    background-image:  "url('')"; /* ·∫¢nh b√™n trong */
    background-size: cover; /* ƒê·∫£m b·∫£o ·∫£nh ph·ªß ƒë·∫ßy */
    background-position: center;
    border: 3px solid #333; /* Vi·ªÅn */
    cursor: pointer;
    align-items: center;
    justify-content: center;
}
#mic2_button {
    width: 70px; /* K√≠ch th∆∞·ªõc n√∫t */
    height: 70px;
    border-radius: 50%; /* L√†m cho n√∫t tr√≤n */
    /*background-image: url("icons/mic1-animation.gif");  ·∫¢nh b√™n trong */
    background-image:  "url('')"; /* ·∫¢nh b√™n trong */
    background-size: cover; /* ƒê·∫£m b·∫£o ·∫£nh ph·ªß ƒë·∫ßy */
    background-position: center;
    border: 3px solid #333; /* Vi·ªÅn */
    cursor: pointer;
    align-items: center;
    justify-content: center;
}
#start_button {
    width: 30px; /* K√≠ch th∆∞·ªõc n√∫t */
    height: 30px;
    border-radius: 50%; /* L√†m cho n√∫t tr√≤n */
    font-size: 16px;
    /*background-image: url("icons/started.png");  ·∫¢nh b√™n trong */
    background-image:  url('icons/start.png'); /* ·∫¢nh b√™n trong */
    background-size: cover; /* ƒê·∫£m b·∫£o ·∫£nh ph·ªß ƒë·∫ßy */
    background-position: center;
    border: none; /* Vi·ªÅn */
    cursor: pointer;
    align-items: center;
    justify-content: center;
}


#loa_button {
  padding: 10px 20px;
  font-size: 16px;
  width: 50px;
  height: 50px;
  border: 2px solid #ccc;
  background-image: url("icons/loa.png");
  background-size: cover;
  background-position: center;
  cursor: pointer;
  align-items: center;
  justify-content: center;
}
.mic1-noi {
  color: rgb(125, 122, 122);
  position: relative;
  top: -4px; /* n√¢ng l√™n 5px */

}
.mic1-dich {
  color: darkgreen;
  font-size: xx-large;
}

.mic2-noi {
  color: #71759f;
  position: relative;
  top: -4px; /* n√¢ng l√™n 5px */

}
.mic2-dich {
  color: darkblue;
  font-size: xx-large;
}
#lang1_select {
  color:rgb(2, 78, 2);
}

#lang2_select {
  text-align: right;       /* CƒÉn n·ªôi dung sang ph·∫£i */
  direction: rtl;          /* ƒê·∫£o h∆∞·ªõng d√≤ng ƒë·ªÉ option hi·ªÉn th·ªã s√°t ph·∫£i */
  color: darkblue;
}
.keyboard-group {
  display: flex;
  justify-content: space-between;
  padding: 0 10%  0% 24%; /* c√°ch bi√™n tr√°i v√† ph·∫£i 20px */
  width: 100%;
  box-sizing: border-box;
}
.keyboard-group div {
  width: 30%; /* ho·∫∑c tu·ª≥ ch·ªânh theo nhu c·∫ßu */
  padding: 0;
  font-size: 24px;
  background-color: transparent;
}
#about{
    color:#b18024;
    font-size: 36px;
}
</style>

</head>
<body>
<h2 ><span id="about">C</span>hat with foreigners with AI translation</h2>
<h2 >üó£Ô∏è<button id="start_button"></button>üë§</h2>

<div id="chatbox">
  <button class="overlay-btn" onclick="removeAllDivs()">Clear üóå</button>
</div>

<br>
<div class="menu-group">
    <select id="lang1_select" onclick="toggleMenu1()" ></select>
    <select id="lang2_select" onclick="toggleMenu2()" ></select>
</div>

<div class="button-group">
    <button id="mic1_button" >üé§</button>
    <button id="loa_button" ></button>
    <button id="mic2_button" >üéôÔ∏è</button>
</div>

<div class="keyboard-group">
    <div id="keyboard1">‚å®Ô∏è</div>
    <div id="keyboard2">‚å®Ô∏è</div>
</div>
<br><br><br>

<script>
const start_button = document.getElementById("start_button");
const chatbox = document.getElementById("chatbox");
const mic1_button = document.getElementById("mic1_button");
const mic2_button = document.getElementById("mic2_button");  
const loa_button = document.getElementById("loa_button");
const lang1_select =  document.getElementById("lang1_select");
const lang2_select =  document.getElementById("lang2_select");

//list cac langs co 13 langs
//lLangs[n][0] se la ten lang ro rang cua nuoc do
//lLangs[n][1] se la voice
const lLangs = 
[['Chinese',    'zh-TW', 'Ti·∫øng ƒê√†i Loan'],
 ['Danish',     'da-DK', 'Ti·∫øng ƒêan M·∫°ch'], 
 ['Dutch',      'nl-NL', 'Ti·∫øng H√† Lan'],
 ['English',    'en-US', 'Ti·∫øng Anh'],
 ['French',     'fr-FR', 'Ti·∫øng Ph√°p'],
 ['German',     'de-DE', 'Ti·∫øng ƒê·ª©c'],
 ['Hebrew',     'he-IL', 'Ti·∫øng Do Th√°i'],
 ['Italy',      'it-IT', 'Ti·∫øng Italy'],
 ['Japanese',   'ja-JP', 'Ti·∫øng Nh·∫≠t'],
 ['Korean',     'ko-KR', 'Ti·∫øng H√†n'],
 ['Lao',        'lo-LA', 'Ti·∫øng L√†o'],
 ['Portuguese', 'pt-PT', 'Ti·∫øng B·ªì ƒê√†o Nha'],
 ['Rusian',     'ru-RU', 'Ti·∫øng Nga'],
 ['Spanish',    'es-MX', 'Ti·∫øng T√¢y Ban Nha'],
 ['Thai',       'th-TH', 'Ti·∫øng Th√°i'],
 ['Turkish',    'tr-TR', 'Ti·∫øng Th·ªï Nhƒ© K·ª≥'],
 ['Vietnamese', 'vi-VN', 'Ti·∫øng Vi·ªát']]

// alert(lLangs[12][0]); //la Danish
//alert(lLangs[12][1]); //la da-DK
//alert(lLangs[12][1].substring(0, 2)); //la da

//day la list cac lang quoc gia, vd French
const listLangCountry = lLangs.map(pt => pt[0]);

//day la list cac MA lang voice, vd fr-FR
const listLangVoice = lLangs.map(pt => pt[1]);
const listMaText = lLangs.map(pt => pt[1].substring(0,2));

//day la list cac Tieng theo tieng Viet, vd Tieng ƒêan M·∫°ch, Ti·∫øng L√†o...
const listLangTiengDich = lLangs.map(pt => pt[2]);

var tiengYcDich='';
var lang1Voice='';
var lang2Voice='';
let selectedVoices = [];

//----------------------------
function populateVoiceList() {
  //neu speechSynthesis khong xac dinh thi thoat ra
  if (typeof speechSynthesis === "undefined") {
    return;
  }
  //neu speechSynthesis co thi
  const voices = speechSynthesis.getVoices();
  // L·∫•y tung gi·ªçng theo list
  let listVoiceC = [];
  //Khoi tao listVoiceC ma moi phan tu cua no deu null (object rong)
  for (let index = 0; index < listLangVoice.length; index++) {
      listVoiceC.push(null);
  }
  //tao list cac object voice
  for (let index = 0; index < listLangVoice.length; index++) {
    if (listLangVoice[index] === 'en-US'){
      listVoiceC[index] = voices.find(v => (v.lang === listLangVoice[index] && (v.name.includes('Samantha') || v.name.includes('Daniel') || v.name.includes('Karen'))));
      if (!listVoiceC[index]){
        listVoiceC[index] = voices.find(v => v.lang === listLangVoice[index]); 
      }
    }else{
      listVoiceC[index] = voices.find(v => v.lang === listLangVoice[index]); 
    }
  }  
  selectedVoices = listVoiceC.filter(Boolean); // lo·∫°i b·ªè null

  // Hi·ªÉn th·ªã trong dropdown lang1_select
  lang1_select.innerHTML = '';
  selectedVoices.forEach((voice, index) => {
    const option = document.createElement('option');
    option.value = index;
    //option.textContent = `${voice.name} (${voice.lang})`;
    option.textContent = listLangCountry[index];
    lang1_select.appendChild(option);
  });
  // ƒê·∫∑t m·∫∑c ƒë·ªãnh ch·ªçn ph·∫ßn t·ª≠ th·ª© 17 (index = 16)
  if (lang1_select.options.length > 1) {
    lang1_select.selectedIndex = 16;
  }

// Hi·ªÉn th·ªã trong dropdown lang2_select
  lang2_select.innerHTML = '';
  selectedVoices.forEach((voice, index) => {
    const option = document.createElement('option');
    option.value = index;
    //option.textContent = `${voice.name} (${voice.lang})`;
    option.textContent = listLangCountry[index];
    lang2_select.appendChild(option);
  });
  // ƒê·∫∑t m·∫∑c ƒë·ªãnh ch·ªçn ph·∫ßn t·ª≠ th·ª© 2 (index = 3)
  if (lang2_select.options.length > 1) {
    lang2_select.selectedIndex = 3;
  }
}
//Thuc thi ham tren
populateVoiceList();
//neu co thay doi thi thuc hien lai ham populateVoiceList()
if (typeof speechSynthesis !== "undefined" && speechSynthesis.onvoiceschanged !== undefined) {
  speechSynthesis.onvoiceschanged = populateVoiceList;
}



loa_button.onclick = () => {
    const text = "Xin ch√†o! ƒê√¢y l√† v√≠ d·ª• s·ª≠ d·ª•ng gi·ªçng n√≥i.";
    const utterance = new SpeechSynthesisUtterance(text);
    const selectedIndex = lang2_select.value;
    utterance.voice = selectedVoices[selectedIndex];
    speechSynthesis.speak(utterance);
}
//loa_button.onclick();

</script>    
</body>
</html>